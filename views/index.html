<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no" />
<title>程序</title>
<link href="./antd.5e8657b5447d6dac525b.css" rel="stylesheet"><link href="./app.cc5ca1bd44f3151960c6.css" rel="stylesheet"></head>
<style>
    html {
        font-size: 26.66667vw;
        max-width: 640px;
        margin: 0 auto;
    }
    @media only screen and (min-width: 640px) {
        html {
            font-size: 170.66667px;
        }
    }
</style>
<script crossorigin src="https://unpkg.com/react@16/umd/react.production.min.js"></script>
<script crossorigin src="https://unpkg.com/react-dom@16/umd/react-dom.production.min.js"></script>
<body>
    <div id='main'></div>
<script type="text/javascript" src="./antd.7e6fbc1a4a424aaf2256.js"></script><script type="text/javascript" src="./common.41fa9ef72c4aa1b7741d.js"></script><script>!function(e){function t(t){for(var n,a,o=t[0],c=t[1],u=t[2],l=0,f=[];l<o.length;l++)a=o[l],i[a]&&f.push(i[a][0]),i[a]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(e[n]=c[n]);for(m&&m(t);f.length;)f.shift()();return s.push.apply(s,u||[]),r()}function r(){for(var e,t=0;t<s.length;t++){for(var r=s[t],n=!0,a=1;a<r.length;a++){var c=r[a];0!==i[c]&&(n=!1)}n&&(s.splice(t--,1),e=o(o.s=r[0]))}return e}var n={},a={1:0},i={1:0},s=[];function o(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,o),r.l=!0,r.exports}o.e=function(e){var t=[];a[e]?t.push(a[e]):0!==a[e]&&{3:1}[e]&&t.push(a[e]=new Promise(function(t,r){for(var n=({}[e]||e)+"."+{3:"61e726d570a612a96e6f"}[e]+".css",i=o.p+n,s=document.getElementsByTagName("link"),c=0;c<s.length;c++){var u=(m=s[c]).getAttribute("data-href")||m.getAttribute("href");if("stylesheet"===m.rel&&(u===n||u===i))return t()}var l=document.getElementsByTagName("style");for(c=0;c<l.length;c++){var m;if((u=(m=l[c]).getAttribute("data-href"))===n||u===i)return t()}var f=document.createElement("link");f.rel="stylesheet",f.type="text/css",f.onload=t,f.onerror=function(t){var n=t&&t.target&&t.target.src||i,s=new Error("Loading CSS chunk "+e+" failed.\n("+n+")");s.request=n,delete a[e],f.parentNode.removeChild(f),r(s)},f.href=i,document.getElementsByTagName("head")[0].appendChild(f)}).then(function(){a[e]=0}));var r=i[e];if(0!==r)if(r)t.push(r[2]);else{var n=new Promise(function(t,n){r=i[e]=[t,n]});t.push(r[2]=n);var s,c=document.createElement("script");c.charset="utf-8",c.timeout=120,o.nc&&c.setAttribute("nonce",o.nc),c.src=function(e){return o.p+""+({}[e]||e)+"."+{3:"960b75d564f8d7192ddb"}[e]+".js"}(e),s=function(t){c.onerror=c.onload=null,clearTimeout(u);var r=i[e];if(0!==r){if(r){var n=t&&("load"===t.type?"missing":t.type),a=t&&t.target&&t.target.src,s=new Error("Loading chunk "+e+" failed.\n("+n+": "+a+")");s.type=n,s.request=a,r[1](s)}i[e]=void 0}};var u=setTimeout(function(){s({type:"timeout",target:c})},12e4);c.onerror=c.onload=s,document.head.appendChild(c)}return Promise.all(t)},o.m=e,o.c=n,o.d=function(e,t,r){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(o.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)o.d(r,n,function(t){return e[t]}.bind(null,n));return r},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="./",o.oe=function(e){throw console.error(e),e};var c=window.webpackJsonp=window.webpackJsonp||[],u=c.push.bind(c);c.push=t,c=c.slice();for(var l=0;l<c.length;l++)t(c[l]);var m=u;s.push([227,0,2]),r()}({0:function(e,t){e.exports=React},142:function(e,t,r){e.exports={topBar:"index__topBar--ff27q",back:"index__back--1t2C-"}},227:function(e,t,r){e.exports=r(467)},255:function(e,t){},258:function(e,t,r){},318:function(e,t,r){},319:function(e,t,r){},32:function(e,t,r){e.exports={mewrapper:"index__mewrapper--1H0UM",topBar:"index__topBar--1p5HF",back:"index__back--1bgCc",save:"index__save--2XWb_",changeItem:"index__changeItem--2aN2i",chPassword:"index__chPassword--1iiG4",saveHighlight:"index__saveHighlight--22jC1",spanAdd:"index__spanAdd--ghCAc",logOut:"index__logOut--3Ee36"}},450:function(e,t,r){},451:function(e,t,r){},460:function(e,t,r){},461:function(e,t,r){},467:function(e,t,r){"use strict";r.r(t);var n=r(7),a=r.n(n),i=r(17),s=r.n(i),o=r(0),c=r.n(o),u=r(8),l=r.n(u),m=r(10),f=r.n(m),d=r(12),p=r.n(d),h=r(14),g=r.n(h),b=r(15),v=r.n(b),w=r(16),y=r.n(w),k=r(9),N=(r(53),r(21)),E=r.n(N),I=r(4),x=r.n(I),O=r(208),j=r.n(O),C=r(1),_=(r(258),r(5)),L=r.n(_),P=r(6),M=r.n(P),A=(r(46),r(25)),F=new(function(){function e(){f()(this,e),this.apiDomain=""}return p()(e,[{key:"get",value:function(e){var t=window.location.protocol+"//tangshisanbaishou.xyz/api/",r={animal:{api:t+"123",nickName:"动物接口测试"},searchName:{api:t+"searchName"},addChatUser:{api:t+"addChatUser"},chatVerify:{api:t+"chatVerify"},addFriend:{api:t+"addFriend"},userInfo:{api:t+"userInfo"},agreeFriendReq:{api:t+"agreeFriendReq"},getAllMessage:{api:t+"getAllMessage"},getMoreMessage:{api:t+"getMoreMessage"},updateUserInfo:{api:t+"updateUserInfo"}};return r[e]&&r[e].api}}]),e}()),R=function(e,t){return 0===e.indexOf(t)};function S(e,t){var r=function(e){return e.split("").reverse().join("")},n=r(e),a=n.indexOf(r(t));return-1!==a?r(n.slice(0,a)):""}function U(e){return e?"url("+e+")":""}var z,D,T,q,B,H,V={get:function(e,t,r){return A.netModel.get(F.get(e),Object.assign(t,{userName:window.chatUserName},r))},post:function(e,t,r){return A.netModel.post(F.get(e),Object.assign(t,{userName:window.chatUserName},r))}},K=function(e,t){return-1!==e.findIndex(function(e){return e.userName===t.userName})};function W(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.map(function(e){return"".concat(e)}).join(" ")}var G=(z=C.c.bound,D=C.c.bound,T=function(e){function t(){var e,r;f()(this,t);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return r=g()(this,(e=v()(t)).call.apply(e,[this].concat(a))),L()(r,"changeInput",q,x()(r)),L()(r,"initMessage",B,x()(r)),L()(r,"changePage",H,x()(r)),r.createMessage=function(e,t){return{content:t,owner:e,timeStamp:(new Date).valueOf()}},r.updateMesRank=function(){(!(arguments.length>0&&void 0!==arguments[0])||arguments[0])&&r.store.socketIoObj.emit("updateMessRank",r.store.userName,r.store.toUserId);var e=r.getChatList(r.store.toUserId)[0];R(e.bothOwner,r.store.userName)?e.user1_flag=e.user2_flag:e.user2_flag=e.user1_flag},r.getChatList=function(e){return r.store.message.filter(function(t){return t.bothOwner.includes(e)})},r.rankMark=function(e,t){var n=r.getChatList(t),a=n[0],i=a.bothOwner,s=a.user1_flag,o=a.user2_flag;if("sender"===e){R(i,r.store.userName)?n[0].user1_flag+=1:n[0].user2_flag+=1}else{var c=R(i,t),u=Math.max(s,o)+1;c?n[0].user1_flag=u:n[0].user2_flag=u}},r.getFriendInfo=function(e){return r.store.friendsList.filter(function(t){return t.userName===e})[0]||{}},r.getAvatar=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r.store.userName;return e===r.store.userName?r.store.avatar:r.store.friendsList.filter(function(t){return t.userName===e})[0].avatar||""},r.getMyInfoObj=function(){return{userName:r.store.userName,nickName:r.store.nickName,avatar:r.store.avatar}},r}return y()(t,e),p()(t,[{key:"store",get:function(){return this.props.chatStore}}]),t}(c.a.Component),q=M()(T.prototype,"changeInput",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return function(e,t,r){e[t]=r.target.value}}}),B=M()(T.prototype,"initMessage",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t,r,n){var a=function(e,t){return[e,t].sort(function(e,t){return e>t}).join("@")}(t,r),i=R(a,t);runInAction(function(){e.store.message.push({message:[e.createMessage(t,n)],bothOwner:a,user1_flag:i?1:0,user2_flag:i?0:1})})}}}),H=M()(T.prototype,"changePage",[C.c],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.store.pageKey=t}}}),T),J=(r(56),r(31)),Q=r.n(J),Y=(r(122),r(26)),X=r.n(Y),Z=(r(57),r(22)),$=r.n(Z);r(318),r(319);var ee,te,re,ne=function(){return c.a.createElement("div",{className:"loadEffect"},new Array(8).fill("").map(function(e,t){return c.a.createElement("span",{key:t})}))},ae=r(142),ie=r.n(ae),se=Object(k.b)("chatStore")((re=te=function(e){function t(){return f()(this,t),g()(this,v()(t).apply(this,arguments))}return y()(t,e),p()(t,[{key:"render",value:function(){var e=this;return c.a.createElement("div",{className:ie.a.topBar,style:{justifyContent:this.props.noBack?"space-around":"space-between"}},!this.props.noBack&&c.a.createElement("div",{className:ie.a.back,onClick:this.props.back},"<"),c.a.createElement("div",{onClick:function(){console.log(Object(C.l)(e.props.chatStore))}},this.props.midContent),this.props.children||!this.props.noBack&&c.a.createElement("div",null,"    "))}}]),t}(c.a.PureComponent),te.defaultProps={noBack:!1,back:function(){},midContent:""},ee=re))||ee,oe=r(65),ce=r.n(oe);var ue,le,me,fe,de,pe,he,ge,be,ve,we,ye,ke,Ne,Ee,Ie,xe,Oe,je,Ce,_e,Le,Pe,Me,Ae,Fe,Re,Se,Ue,ze,De,Te,qe,Be,He,Ve,Ke,We,Ge,Je,Qe,Ye=function(e){var t=e.info,r=t.userName,n=t.nickName,a=t.avatar;return React.createElement("div",{className:ce.a.meavatarbar},React.createElement("div",{className:ce.a.meavatar,style:{backgroundImage:U(a)}}),React.createElement("div",{className:ce.a.wrapper},React.createElement("div",{className:ce.a.nickname},n),React.createElement("div",{className:ce.a.uid},"chatID: ",r)))},Xe="FRIENDS",Ze="ADD",$e="ME",et={0:Xe,1:Ze,2:$e,3:"CHAT",4:"FRIENDINFO"},tt=$.a.TextArea,rt=Object(k.b)("chatStore")(ue=Object(k.c)((le=function(e){function t(){var e,r;f()(this,t);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(r=g()(this,(e=v()(t)).call.apply(e,[this].concat(i)))).messageList=r.getChatList(r.store.toUserId),L()(r,"scrollLock",me,x()(r)),r.componentDidMount=s()(a.a.mark(function e(){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r.updateMesRank(),r.box=document.getElementsByClassName("chat-box")[0],r.boxScroll(),Object(C.d)(function(){var e;((null===(e=r.messageList[0])||void 0===e?void 0:e.message)||[]).length>0&&setTimeout(r.boxScroll,0)}),new IntersectionObserver(function(){var e=s()(a.a.mark(function e(t){var n,i,s,o,c,u,l;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t[0].intersectionRatio<=0)){e.next=2;break}return e.abrupt("return");case 2:if(n=r.messageList[0]||"",i=15,!(n&&n.message.length>0)){e.next=12;break}if(s=n.user1_flag,o=n.user2_flag,c=n.message,!((u=Math.max(s,o)-c.length)<=0)){e.next=9;break}return e.abrupt("return");case 9:i=u>15?15:u,e.next=13;break;case 12:return e.abrupt("return");case 13:return r.scrollLock=!0,e.next=16,V.get("getMoreMessage",{currentLength:r.messageList[0].message.length,toFriend:r.store.toUserId,length:i},{});case 16:l=e.sent,Object(C.j)(function(){r.messageList[0].message=l.message.concat(Object(C.l)(r.messageList[0].message))}),setTimeout(function(){r.scrollLock=!1},0);case 19:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()).observe(document.getElementById("chat-mess-observer"));case 6:case"end":return e.stop()}},e)})),r.boxScroll=function(){!r.scrollLock&&r.box.scrollTo(0,r.box.scrollHeight)},r.handleSubmit=function(e){e.preventDefault(),r.props.form.validateFields(function(){var e=s()(a.a.mark(function e(t,n){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n.message){e.next=2;break}return e.abrupt("return");case 2:r.messageList.length>0?Object(C.j)(function(){r.messageList[0].message.push(r.createMessage(r.store.userName,n.message))}):r.initMessage(r.store.userID,r.store.toUserId,n.message),r.rankMark("sender",r.store.toUserId),r.store.socketIoObj.emit("chat message",r.store.toUserId,r.store.userName,n.message),r.props.form.resetFields();case 6:case"end":return e.stop()}},e)}));return function(t,r){return e.apply(this,arguments)}}())},r.getMessage=function(){var e=r.messageList,t=(e=e.length>0?e[0].message:[]).reverse().map(function(e,t){var n=r.store.userName===e.owner,a=c.a.createElement("div",{className:"user-avatar",style:{backgroundImage:U(r.getAvatar(e.owner))}}),i=c.a.createElement("div",{className:"user-say"},e.content);return c.a.createElement("div",{key:t,className:"word-box "+(n?"right-box":"left-box")},n?i:a,n?a:i)});return t.push(c.a.createElement("div",{key:"0_0",id:"chat-mess-observer"},r.scrollLock?ne():"1")),t},r}return y()(t,e),p()(t,[{key:"render",value:function(){var e=this.props.form.getFieldDecorator;return c.a.createElement("div",null,c.a.createElement(se,{midContent:this.getFriendInfo(this.store.toUserId).nickName||this.store.toUserId,back:this.changePage.bind(this,Xe)},c.a.createElement("div",{className:"chat-top-more",onClick:this.changePage.bind(this,"FRIENDINFO")},". . .")),c.a.createElement("div",{className:"chat-box-wrapper"},c.a.createElement("div",{className:"chat-box"},this.getMessage())),c.a.createElement(X.a,{onSubmit:this.handleSubmit,className:"chat-form"},c.a.createElement(X.a.Item,{className:"chat-text-input"},e("message",{rules:[{required:!0,message:"empty message!"}],initialValue:""})(c.a.createElement(tt,{className:"chat-text",autosize:{minRows:1,maxRows:6},placeholder:"put something in!"}))),c.a.createElement(Q.a,{type:"primary",htmlType:"submit",className:"chat-send"},"Send")))}}]),t}(G),me=M()(le.prototype,"scrollLock",[C.i],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),ue=le))||ue)||ue,nt=X.a.create({name:"normal_login"})(rt),at=(r(450),$.a.Search),it=Object(k.b)("chatStore")(fe=Object(k.c)((de=function(e){function t(){var e,r;f()(this,t);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return r=g()(this,(e=v()(t)).call.apply(e,[this].concat(i))),L()(r,"removeItemFromArray",pe,x()(r)),r.searchName=function(){var e=s()(a.a.mark(function e(t){var n;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:if(t!==r.store.userName){e.next=5;break}return E.a.error("不能添加自己"),e.abrupt("return");case 5:return e.next=7,V.get("searchName",{searchName:t},{});case 7:n=e.sent,Object(C.j)(function(){r.store.searchList="not found"===n?[]:n});case 9:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),r.addFriend=function(){var e=s()(a.a.mark(function e(t){var n;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,V.get("addFriend",{friendName:t},{});case 2:"friend request success!"===(n=e.sent)?(E.a.success("请求发送成功"),r.store.socketIoObj.emit("informFriend",{type:"addReq",friendName:t,IAm:r.store.userName})):"A friend request has been sent"===n&&E.a.error("好友请求已发送，请勿重复发送");case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),r.getList=function(e){var t="search"===e;return(t?r.store.searchList:r.store.friendRequest).map(function(e,n){var a=K(r.store.friendsList,e)&&K(e.friendsList,{userName:r.store.userName}),i=t?a?"Added":"Add":"Agree";return c.a.createElement("div",{className:"search-person",key:n},c.a.createElement(Q.a,{type:"primary",disabled:!!t&&a,className:"add-button",onClick:t?r.addFriend.bind(x()(r),e.userName):r.agree.bind(x()(r),e)},i),!t&&c.a.createElement(Q.a,{type:"dashed",onClick:function(){return r.ignore(e.userName)},className:"delete-friReq"},"Ignore"),c.a.createElement(Ye,{info:e}))})},r.ignore=function(){var e=s()(a.a.mark(function e(t){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,V.post("updateUserInfo",{changeObj:{delete:{value:t,key:"friendRequest"}}},{});case 2:e.sent,Object(C.j)(function(){var e=r.store.friendRequest.findIndex(function(e){return e.userName===t});r.store.friendRequest.splice(e,1)});case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),r.agree=function(){var e=s()(a.a.mark(function e(t){var n;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.userName,e.next=3,V.get("agreeFriendReq",{friendName:n},{});case 3:"have a new friend!"===e.sent&&(E.a.success("已添加好友"),r.store.socketIoObj.emit("informFriend",{type:"agreeReq",friendName:n,IAm:r.store.userName}),Object(C.j)(function(){K(r.store.friendsList,t)||r.store.friendsList.push(t)}),r.removeItemFromArray(r.store.friendRequest,n));case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),r.getReqList=function(){return r.store.friendRequest.map(function(e,t){return c.a.createElement("div",{key:t,className:"search-person"},c.a.createElement("div",null,e),c.a.createElement(Q.a,{type:"primary",onClick:r.agree.bind(x()(r),e)},"I agree!"))})},r}return y()(t,e),p()(t,[{key:"render",value:function(){var e=this;return c.a.createElement("div",{className:"add-container"},c.a.createElement(se,{noBack:!0,midContent:"Contats"}),c.a.createElement(at,{placeholder:"search chatID to add new friend!",style:{marginTop:".1rem"},onSearch:function(t){e.searchName(t)},enterButton:!0}),c.a.createElement("div",{className:"search-list"},this.getList("search")),c.a.createElement("div",{className:"search-list"},this.getList("addReq")))}}]),t}(G),pe=M()(de.prototype,"removeItemFromArray",[C.c],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return function(e,t){var r=e.findIndex(function(e){return e.userName===t});-1!==r&&e.splice(r,1)}}}),fe=de))||fe)||fe,st=r(32),ot=r.n(st),ct=Object(o.lazy)(function(){return new Promise(function(e){r.e(3).then(function(t){e(r(568))}.bind(null,r)).catch(r.oe)})}),ut=function(e){return c.a.createElement(o.Suspense,{fallback:ne()},c.a.createElement(ct,e))},lt=Object(k.b)("chatStore")(he=Object(k.c)((ge=function(e){function t(){var e,r;f()(this,t);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(r=g()(this,(e=v()(t)).call.apply(e,[this].concat(i)))).state={status:"profile"},L()(r,"newNickname",be,x()(r)),L()(r,"oldPass",ve,x()(r)),L()(r,"newPass",we,x()(r)),L()(r,"newPassAgain",ye,x()(r)),L()(r,"base64Img",ke,x()(r)),r.clickChange=function(e){r.setState({status:e})},L()(r,"changeTransmisValue",Ne,x()(r)),r.changeNickname=function(){return c.a.createElement($.a,{defaultValue:r.store.nickName,onChange:r.changeTransmisValue.bind(x()(r),"newNickname"),style:{marginTop:".2rem"}})},L()(r,"updateImg",Ee,x()(r)),r.changePassword=function(){return c.a.createElement(c.a.Fragment,null,c.a.createElement($.a.Password,{addonBefore:c.a.createElement("span",{className:ot.a.spanAdd},"original password"),onChange:r.changeInput.bind(x()(r),x()(r),"oldPass"),placeholder:"Enter old password",style:{marginTop:".2rem"}}),c.a.createElement($.a.Password,{addonBefore:c.a.createElement("span",{className:ot.a.spanAdd},"new password"),placeholder:"Enter new password",onChange:r.changeInput.bind(x()(r),x()(r),"newPass")}),c.a.createElement($.a.Password,{addonBefore:c.a.createElement("span",{className:ot.a.spanAdd},"confirm password"),placeholder:"Enter new password again",onChange:r.changeInput.bind(x()(r),x()(r),"newPassAgain")}))},r.save=function(){var e=s()(a.a.mark(function e(t){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r.changeMap[t].isHighLight()){e.next=2;break}return e.abrupt("return");case 2:if("Password"!==t){e.next=14;break}if(r.newPass===r.newPassAgain){e.next=8;break}return E.a.error("两次新密码输入不一致"),e.abrupt("return");case 8:return e.next=10,V.post("chatVerify",{userName:r.store.userName,passWord:r.oldPass},{});case 10:if(e.t0=e.sent,"verified"===e.t0){e.next=14;break}return E.a.error("原密码输入错误"),e.abrupt("return");case 14:return e.next=16,V.post("updateUserInfo",{changeObj:r.changeMap[t].transferObj()},{});case 16:"success"===e.sent&&(E.a.success("保存成功"),Object(C.j)(function(){r.changeMap[t].postCB()}));case 18:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),r.changeMap={Nickname:{render:r.changeNickname,isHighLight:function(){return r.newNickname!==r.store.nickName},transferObj:function(){return{nickName:r.newNickname}},postCB:function(){r.store.nickName=r.newNickname}},Avatar:{render:function(){return c.a.createElement(ut,{updateIMg:r.updateImg})},isHighLight:function(){return""!==r.base64Img},transferObj:function(){return{avatar:r.base64Img}},postCB:function(){r.store.avatar=r.base64Img}},Password:{render:r.changePassword,isHighLight:function(){return r.oldPass&&r.newPass&&r.newPassAgain},transferObj:function(){return{passWord:r.newPass}},postCB:function(){}}},r.logOut=function(){Object(A.writeCookie)({password:""},10),window.location.href="/login.html"},r}return y()(t,e),p()(t,[{key:"render",value:function(){var e=this;return c.a.createElement("div",{className:ot.a.mewrapper},"profile"===this.state.status?c.a.createElement(c.a.Fragment,null,c.a.createElement(se,{noBack:!0,midContent:"Me"}),c.a.createElement(Ye,{info:this.getMyInfoObj()}),["Nickname","Avatar","Password"].map(function(t,r){return c.a.createElement("div",{key:r,className:W(ot.a.changeItem,ot.a["ch"+t]),onClick:e.clickChange.bind(e,t)},t)}),c.a.createElement("div",{className:W(ot.a.changeItem,ot.a.logOut),onClick:this.logOut},"Log Out")):c.a.createElement("div",{className:ot.a.edit},c.a.createElement(se,{back:this.clickChange.bind(this,"profile"),midContent:this.state.status},c.a.createElement("div",{onClick:this.save.bind(this,this.state.status),className:W(ot.a.save,this.changeMap[this.state.status].isHighLight()?ot.a.saveHighlight:"")},"save")),this.changeMap[this.state.status].render()))}}]),t}(G),be=M()(ge.prototype,"newNickname",[C.i],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.store.nickName}}),ve=M()(ge.prototype,"oldPass",[C.i],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),we=M()(ge.prototype,"newPass",[C.i],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),ye=M()(ge.prototype,"newPassAgain",[C.i],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),ke=M()(ge.prototype,"base64Img",[C.i],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),Ne=M()(ge.prototype,"changeTransmisValue",[C.c],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t,r){e[t]=r.target.value}}}),Ee=M()(ge.prototype,"updateImg",[C.c],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.base64Img=t}}}),he=ge))||he)||he,mt=(r(451),Object(k.b)("chatStore")(Ie=Object(k.c)((xe=function(e){function t(){var e,r;f()(this,t);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return r=g()(this,(e=v()(t)).call.apply(e,[this].concat(a))),L()(r,"entryTalk",Oe,x()(r)),r.getFriend=function(){return r.store.friendsList.map(function(e,t){var n=r.store.message.filter(function(t){return t.bothOwner.includes(e.userName)}),a="",i=0;if(n.length>0){var s=n[0].message,o=n[0],u=o.bothOwner,l=o.user1_flag,m=o.user2_flag;i=(i=R(u,r.store.userName)?m-l:l-m)>99?"99+":i,a=s[s.length-1].content}return c.a.createElement("div",{className:"friend-item",key:t,onClick:r.entryTalk.bind(x()(r),e.userName)},c.a.createElement("div",{className:"friend-icon",style:{backgroundImage:U(r.getAvatar(e.userName))}},i>0&&c.a.createElement("div",{className:"friend-mes-info"},i)),c.a.createElement("div",{className:"friend-content"},c.a.createElement("div",{className:"friend-name"},e.nickName),c.a.createElement("div",{className:"fri-say"},a)))})},r}return y()(t,e),p()(t,[{key:"render",value:function(){return c.a.createElement("div",{className:"friendList-wrapper"},c.a.createElement(se,{noBack:!0,midContent:"IChat"}),c.a.createElement("div",{className:"fri-list-name"},"好友列表"),c.a.createElement("div",null,this.getFriend()))}}]),t}(G),Oe=M()(xe.prototype,"entryTalk",[C.c],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.store.pageKey="CHAT",e.store.toUserId=t}}}),Ie=xe))||Ie)||Ie),ft=(r(452),r(211)),dt=r.n(ft),pt=r(66),ht=r.n(pt),gt=Object(k.b)("chatStore")(je=Object(k.c)((Ce=function(e){function t(){var e,r;f()(this,t);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return r=g()(this,(e=v()(t)).call.apply(e,[this].concat(i))),L()(r,"status",_e,x()(r)),L()(r,"newFriendNickName",Le,x()(r)),L()(r,"showDialog",Pe,x()(r)),L()(r,"clickChange",Me,x()(r)),L()(r,"changeTransmisValue",Ae,x()(r)),r.save=s()(a.a.mark(function e(){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r.isHighLight()){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,V.post("updateUserInfo",{changeObj:{fridendNickName:{newNickName:r.newFriendNickName,friend:r.store.toUserId}}},{});case 4:"success"===e.sent&&(E.a.success("保存成功"),Object(C.j)(function(){r.store.friendsList.filter(function(e){return e.userName===r.store.toUserId})[0].nickName=r.newFriendNickName}));case 6:case"end":return e.stop()}},e)})),r.isHighLight=function(){return r.newFriendNickName!==r.getFriendInfo(r.store.toUserId).nickName},r.handleOk=s()(a.a.mark(function e(){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,V.post("updateUserInfo",{changeObj:{delete:{key:"friendsList",value:r.store.toUserId}}},{});case 2:Object(C.j)(function(){var e=r.store.friendsList.findIndex(function(e){return e.userName===r.store.toUserId});r.store.friendsList.splice(e,1)}),r.handleCancel(),r.changePage(Xe);case 5:case"end":return e.stop()}},e)})),L()(r,"handleCancel",Fe,x()(r)),r}return y()(t,e),p()(t,[{key:"render",value:function(){var e=this,t=this.getFriendInfo(this.store.toUserId),r=(t.avatar,t.nickName);t.userName;return c.a.createElement("div",{className:ht.a.mewrapper},"profile"===this.status?c.a.createElement(c.a.Fragment,null,c.a.createElement(se,{midContent:"profile",back:this.changePage.bind(this,"CHAT")}),c.a.createElement(Ye,{info:t}),["Set remark","Delete friend"].map(function(t,r){return c.a.createElement("div",{key:r,className:W(ht.a.changeItem,"Delete friend"===t?ht.a.last:""),onClick:e.clickChange.bind(e,t)},t)}),c.a.createElement(dt.a,{title:"Pay Attention!",visible:this.showDialog,onOk:this.handleOk,onCancel:this.handleCancel},c.a.createElement("p",null,"Are you Sure to Delete a Friend(".concat(r,")?")))):c.a.createElement("div",null,c.a.createElement(se,{back:this.clickChange.bind(this,"profile"),midContent:this.status},c.a.createElement("div",{onClick:this.save,className:W(ht.a.save,this.isHighLight()?ht.a.saveHighlight:"")},"save")),c.a.createElement($.a,{defaultValue:this.getFriendInfo(this.store.toUserId).nickName,onChange:this.changeTransmisValue.bind(this,"newFriendNickName"),style:{marginTop:".2rem"}})))}}]),t}(G),_e=M()(Ce.prototype,"status",[C.i],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"profile"}}),Le=M()(Ce.prototype,"newFriendNickName",[C.i],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),Pe=M()(Ce.prototype,"showDialog",[C.i],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Me=M()(Ce.prototype,"clickChange",[C.c],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){"Delete friend"===t?e.showDialog=!0:e.status=t}}}),Ae=M()(Ce.prototype,"changeTransmisValue",[C.c],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t,r){e[t]=r.target.value}}}),Fe=M()(Ce.prototype,"handleCancel",[C.c],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.showDialog=!1}}}),je=Ce))||je)||je,bt=Object(k.b)("chatStore")(Re=Object(k.c)(Re=function(e){function t(){var e,r;f()(this,t);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return(r=g()(this,(e=v()(t)).call.apply(e,[this].concat(a)))).getTab=function(){return c.a.createElement("div",{className:"bottom-tab"},["friends","contats","me"].map(function(e,t){var n="contats"===e&&r.store.friendRequest.length>0;return c.a.createElement("div",{className:"bottom-item"+(r.store.pageKey===et[t]?" item-focus":"")+(n?" new-friend-req":""),key:t,onClick:r.changePage.bind(x()(r),et[t])},e)}))},r}return y()(t,e),p()(t,[{key:"componentDidMount",value:function(){var e=this;window.chatUserName=this.store.userName;var t=window.location.protocol;Object(C.j)(function(){var r=t+"://tangshisanbaishou.xyz";e.store.socketIoObj=j()(r,{path:"/mySocket"})}),this.store.socketIoObj.on("chat message",function(t){var r=t.owner,n=t.message;Object(C.j)(function(){var t=e.getChatList(r);t.length>0?t[0].message.push(e.createMessage(r,n)):e.initMessage(r,e.store.userName,n)}),"CHAT"===e.store.pageKey?e.updateMesRank():e.rankMark("reveiver",t.owner)}),this.store.socketIoObj.on("system notification",function(t){var r=t.type,n=t.message;({NOT_YOUR_FRIEND:function(){return E.a.error("对方开启好友验证，本消息无法送达")},NEW_FRIEND_REQ:function(){return Object(C.j)(function(){e.store.friendRequest.push(n)})},REQ_AGREE:function(){K(e.store.friendsList,n)||Object(C.j)(function(){e.store.friendsList.push(n)})}})[r]()}),this.store.socketIoObj.emit("register",this.store.userName)}},{key:"render",value:function(){var e={FRIENDS:c.a.createElement(mt,null),ADD:c.a.createElement(it,null),ME:c.a.createElement(lt,null),CHAT:c.a.createElement(nt,null),FRIENDINFO:c.a.createElement(gt,null)};return c.a.createElement("div",{className:"main-container"},e[this.store.pageKey],[Xe,Ze,$e].includes(this.store.pageKey)&&this.getTab())}}]),t}(G))||Re)||Re,vt=(r(147),r(23)),wt=r.n(vt),yt=(r(460),X.a.Item,Object(k.c)(Se=function(e){function t(){var e,r;f()(this,t);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(r=g()(this,(e=v()(t)).call.apply(e,[this].concat(i)))).handleSubmit=function(e){e.preventDefault(),r.props.form.validateFields(function(){var e=s()(a.a.mark(function e(t,r){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=5;break}return e.next=3,A.netModel.post(F.get("chatVerify"),{userName:r.userName,passWord:r.password},{});case 3:"verified"===e.sent?(Object(A.writeCookie)(r,10),window.location.href="/home.html"):E.a.error("账号密码错误");case 5:case"end":return e.stop()}},e)}));return function(t,r){return e.apply(this,arguments)}}())},r}return y()(t,e),p()(t,[{key:"render",value:function(){var e=this.props.form.getFieldDecorator,t=Object(A.parseCookie)(),r=t.userName,n=t.password;return c.a.createElement(X.a,{onSubmit:this.handleSubmit,className:"login-form"},c.a.createElement(X.a.Item,null,e("userName",{rules:[{required:!0,message:"Please input your username!"}],initialValue:r})(c.a.createElement($.a,{prefix:c.a.createElement(wt.a,{type:"user",style:{color:"rgba(0,0,0,.25)"}}),placeholder:"Username"}))),c.a.createElement(X.a.Item,null,e("password",{rules:[{required:!0,message:"Please input your Password!"}],initialValue:n})(c.a.createElement($.a,{prefix:c.a.createElement(wt.a,{type:"lock",style:{color:"rgba(0,0,0,.25)"}}),type:"password",placeholder:"Password"}))),c.a.createElement("a",{className:"login-register",href:"/register.html"},"register new account"),c.a.createElement(Q.a,{type:"primary",htmlType:"submit",className:"login-form-button"},"Log in"))}}]),t}(c.a.Component))||Se),kt=X.a.create({name:"normal_login"})(yt),Nt=(r(461),X.a.Item,Object(k.c)(Ue=function(e){function t(){var e,r;f()(this,t);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(r=g()(this,(e=v()(t)).call.apply(e,[this].concat(i)))).handleSubmit=function(e){e.preventDefault(),r.props.form.validateFields(function(){var e=s()(a.a.mark(function e(t,r){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=8;break}if(r.password===r.repassword){e.next=4;break}return E.a.error("两次密码输入不一致"),e.abrupt("return");case 4:return e.next=6,A.netModel.post(F.get("addChatUser"),{userName:r.userName,passWord:r.password},{});case 6:"add user success!"===e.sent?(Object(A.writeCookie)(r,30),window.location.href="/home.html"):E.a.error("用户名已被占用");case 8:case"end":return e.stop()}},e)}));return function(t,r){return e.apply(this,arguments)}}())},r}return y()(t,e),p()(t,[{key:"render",value:function(){var e=this.props.form.getFieldDecorator;return c.a.createElement(X.a,{onSubmit:this.handleSubmit,className:"login-form"},c.a.createElement(X.a.Item,null,e("userName",{rules:[{required:!0,message:"Please input your username!"}]})(c.a.createElement($.a,{prefix:c.a.createElement(wt.a,{type:"user",style:{color:"rgba(0,0,0,.25)"}}),placeholder:"Username"}))),c.a.createElement(X.a.Item,null,e("password",{rules:[{required:!0,message:"Please input your Password!"}]})(c.a.createElement($.a,{prefix:c.a.createElement(wt.a,{type:"lock",style:{color:"rgba(0,0,0,.25)"}}),type:"password",placeholder:"Password"}))),c.a.createElement(X.a.Item,null,e("repassword",{rules:[{required:!0,message:"Please input your Password again !"}]})(c.a.createElement($.a,{prefix:c.a.createElement(wt.a,{type:"lock",style:{color:"rgba(0,0,0,.25)"}}),type:"password",placeholder:"rePassword"}))),c.a.createElement(Q.a,{type:"primary",htmlType:"submit",className:"login-form-button"},"Register"))}}]),t}(c.a.Component))||Ue),Et=X.a.create({name:"normal_login"})(Nt),It=r(212),xt=r(52),Ot=(ze=function e(t){f()(this,e),L()(this,"message",De,this),L()(this,"userName",Te,this),L()(this,"toUserId",qe,this),L()(this,"pageKey",Be,this),L()(this,"searchList",He,this),L()(this,"nickName",Ve,this),L()(this,"avatar",Ke,this),L()(this,"friendsList",We,this),L()(this,"friendRequest",Ge,this),L()(this,"socketIoObj",Je,this),this.message=(null===t||void 0===t?void 0:t.message)||[],this.userName=(null===t||void 0===t?void 0:t.userName)||"",this.nickName=(null===t||void 0===t?void 0:t.nickName)||"",this.avatar=(null===t||void 0===t?void 0:t.avatar)||"",this.friendsList=(null===t||void 0===t?void 0:t.friendsList)||[],this.friendRequest=(null===t||void 0===t?void 0:t.friendRequest)||[],this.message=(null===t||void 0===t?void 0:t.message)||[]},De=M()(ze.prototype,"message",[C.i],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Te=M()(ze.prototype,"userName",[C.i],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"1"}}),qe=M()(ze.prototype,"toUserId",[C.i],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"2"}}),Be=M()(ze.prototype,"pageKey",[C.i],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Xe}}),He=M()(ze.prototype,"searchList",[C.i],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Ve=M()(ze.prototype,"nickName",[C.i],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),Ke=M()(ze.prototype,"avatar",[C.i],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),We=M()(ze.prototype,"friendsList",[C.i],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Ge=M()(ze.prototype,"friendRequest",[C.i],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Je=M()(ze.prototype,"socketIoObj",[C.i],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),ze),jt=Object(k.c)(Qe=function(e){function t(){return f()(this,t),g()(this,v()(t).apply(this,arguments))}return y()(t,e),p()(t,[{key:"render",value:function(){var e=new Ot(this.props.userInfo);return c.a.createElement(k.a,{chatStore:e},c.a.createElement(It.a,null,c.a.createElement(xt.a,{path:"/login.html",component:kt}),c.a.createElement(xt.a,{path:"/register.html",component:Et}),c.a.createElement(xt.a,{path:"/home.html",component:bt})))}}]),t}(c.a.Component))||Qe,Ct=Object(A.parseCookie)(),_t=Ct.userName,Lt=Ct.password,Pt=function(){var e=s()(a.a.mark(function e(t){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A.netModel.post(F.get("chatVerify"),{userName:_t,passWord:Lt},{});case 2:"verified"!==e.sent&&"home"===t&&(window.location.href="/login.html");case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}();(function(){var e=s()(a.a.mark(function e(){var t,r,n,i,s;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=document.getElementById("main"),r=/.*(?=\.html)/.exec(window.location.pathname)[0],n=S(r,"/"),Pt(n),e.next=7,A.netModel.get(F.get("userInfo"),{userName:_t},{});case 7:if(i=e.sent,"home"!==n){e.next=13;break}return e.next=11,A.netModel.get(F.get("getAllMessage"),{userName:_t},{});case 11:s=e.sent,i.message=s;case 13:l.a.render(c.a.createElement(jt,{userInfo:i}),t);case 14:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}})()()},65:function(e,t,r){e.exports={meavatarbar:"index__meavatarbar--3e864",meavatar:"index__meavatar--hlpth",nickname:"index__nickname--1Dyy4",uid:"index__uid--2zIzM",wrapper:"index__wrapper--1lUpe"}},66:function(e,t,r){e.exports={mewrapper:"index__mewrapper--2LyFk",changeItem:"index__changeItem--16rHI",last:"index__last--8mSUY",save:"index__save--1cNhz",saveHighlight:"index__saveHighlight--ueP-2"}},8:function(e,t){e.exports=ReactDOM}});</script></body>
<!-- <script src="https://cdn.bootcss.com/jquery/1.12.4/jquery.min.js"></script> -->
<!-- <script src="http://wechatfe.github.io/vconsole/lib/vconsole.min.js?v=3.2.0"></script>
<script>
  // init vConsole
  var vConsole = new VConsole();
  console.log('Hello world');
</script> -->
</html>